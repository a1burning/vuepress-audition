---
title: Vuex
tags: 
  - vue
date: 2022-03-16
prev: ./02.md
next: ./04.md
sidebarDepth: 5
---

[[toc]]

## 1. 聊聊Vuex是什么？<Badge text="TODO" type="error"/>

## 2. Redux 和 Vuex 的设计思想

不管是 Vue，还是 React，都需要管理状态（state），比如组件之间都有共享状态的需要。  
父子组件之间，兄弟组件之间共享状态，往往需要写很多没有必要的代码。  
对于状态管理的解决思路就是：把组件之间需要共享的状态抽取出来，遵循特定的约定，统一来管理，让状态的变化可以预测。

## 2. 说说actions和mutations的实现机制和区别是什么？

:::details 查看答案
一般来说，我们标准是将同步修改的代码用mutations实现，将异步修改的代码用actions实现。  
但是其底层原理上：mutations里面也是可以写异步代码的。
- mutations是通过commit触发的，源码中没有限制异步操作。
- 每次commit执行完mutations中回调的时候，控制浏览器插件进行跟踪，如果你浏览器没有Vue的插件，devtool是一个undefined，如果你在mutation中使用了异步操作，devtool的钩子会先于mutations回调执行，导致无法捕捉store的变化。
- 本身不使用浏览器进行调试的时候，mutations里是可以包含异步操作的，只是影响使用插件来定位bug。

- 而actions中，返回了一个promise对象，本质是执行了代码最后还是用commit提交内容。只是把commit里，devtool和mutations的回调同步处理了。

:::right
[参考资料](https://www.jianshu.com/p/be6398f05214)
:::


## 3. 为什么 Vuex 的 mutation 和 Redux 的 reducer 中 不能做异步操作？

:::details 查看答案
每次commit执行完mutations中回调的时候，控制浏览器插件进行跟踪，如果你浏览器没有Vue的插件，devtool是一个undefined，如果你在mutation中使用了异步操作，devtool的钩子会先于mutations回调执行，导致无法捕捉store的变化。

我们如果正在debug一个app并观察devtool中的mutation日志，每一条 mutation 被记录，devtools 都需要捕捉到前一状态和后一状态的快照。而异步操作的回调函数无法在mutation触发的时候立马拿到结果，所以改变不可追踪。
:::


## 3. 怎么实现一个简单的Vuex？ <Badge text="TODO" type="error"/>